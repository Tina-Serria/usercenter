## 1.表

user

id     512    主键 自增    

user_account  512   账号   唯一

user_name    用户名 不唯一

user_password   密码  MD5->Hex

user_gender    性别 0 ->女  1 -> 男

user_email          正则匹配  邮箱

user_phone       

user_status      0 正常  1 封号

user_role          0 普通  1 管理员

create_time       DateTime

update_time       DateTime

deleted               0->未删除  1->已逻辑删除

## 2.功能

检验不通过时抛出对应业务异常。

### 2.0.全局TODO

1.事务处理

### 2.1.注册

1.输入

`String userName, String userPassword, String repeatPassword`

2.校验

* 参数不能为空、null 、不可字符
* 用户名合法,4-32位，只能包含数字， 字母，中文
* 两次密码相同
* 密码合法

3.获取当前最新用户

4.如果没有用户则账号为10000，否则账号加一

5.创建用户对象，写入数据库

6.返回用户对象

### 2.2.登录

1.输入

​	`Long userAccount, String userPassword`

2.校验

* 小于100000的账号无法登录
* 密码不能为空
* 密码需要合法

3.查询。

​	通过账号和密码从数据库查询。密码加盐MD5加密。

4.返回查询结果。为空抛出业务异常。

#### TODO

实现单点登录，Cookie-Session。

### 2.3.退出

1.输入

​	`Long userAccount`

2.校验

* 校验账号

3.清除Session、JWT

4.返回结果。

#### TODO

实现Cookie-Session、JWT清除

### 2.4.查询

#### 2.4.1查询一个

1.输入

 	`Long userAccount`

2.校验

* 小于100000直接抛出业务异常

* 账号是否合法

3.查询

4.返回查询结果

#### 2.4.2.查询全部

1.输入

​	无

2.校验

* 只有管理员，才能查询全部。

3.查询

4.返回查询结果

#### 2.4.3.条件查询

1.输入

​	查询条件，性别，时间，用户名模糊匹配...

2.校验

* 性别校验
* 时间校验，不早于系统时间，不快于当前时间。
* 用户名校验，同注册用户名校验

3.查询

4.返回结果。

#### TODO

1.查询全部，条件查询的管理员权限鉴别

2.分页查询

### 2.5.修改

1.输入

​	User对象

2.检验

​	对可以修改的非空字段进行校验

​	用户名，密码，性别，邮箱，手机，状态，角色

3.写入

​	如果存在记录，对非空字段进行写入

4.返回结果。

#### TODO

1.对于管理员，批量修改

2.普通登录状态可修改自己，鉴权，登录状态。

### 2.6.删除/注销

​	逻辑删除

1.输入

​	`List<Long> userAccount`

2.校验

* 权限校验，如果是管理员，可批量删除，删除别人。否则只能删除自己的账号。
* 账号校验

3.修改账号deleted字段

4.返回修改结果

#### TODO

自己注销也需要清理Session-Cookie，JWT



### 2.7.JWT实现单点登录

1.Inter  ceptor拦截所有请求。如果是登录login请求则放行

2.如果是别的请求进行JWT验证。

3.验证成功则放行请求。否则返回业务异常。

















































